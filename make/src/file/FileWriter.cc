#include "common.h"
#include "FileWriter.h"

#include "String.h"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// @class:    FileWriter
// @method:   constructor
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FileWriter::FileWriter (const String & file_name)
: m_fp (NULL)
{
  m_fp = fopen (file_name.cStr (), "w");

  if (m_fp == NULL)
  {
    printError ("Can not write file '");
    printError (file_name.cStr (), ERROR_COLOR_PURPLE);
    printError ("'.");
    VERIFY_INPUT_VALID (false, "");
  }
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// @class:    FileWriter
// @method:   destructor
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FileWriter::~FileWriter ()
{
  if (m_fp != NULL)
  {
    fclose (m_fp);
  }
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// @class:    FileWriter
// @method:   operator<<
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FileWriter &
FileWriter::operator<< (const char * data)
{
  return append (data);
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// @class:    FileWriter
// @method:   operator<<
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FileWriter &
FileWriter::operator<< (const String & data)
{
  return append (data.cStr ());
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// @class:    FileWriter
// @method:   append
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FileWriter &
FileWriter::append (const char * data)
{
  fprintf (m_fp, "%s", data);

  return *this;
}

